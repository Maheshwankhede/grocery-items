<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Grocery & Kirana Checklist</title>

<!-- Bootstrap 5 CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- Bootstrap Icons -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

<style>
  :root {
    --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    --success-gradient: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
  }
  
  body {
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    min-height: 100vh;
    padding-top: 80px;
    padding-bottom: 60px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }

  .app-header {
    background: var(--primary-gradient);
    color: white;
    padding: 20px 0;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    margin-bottom: 20px;
  }

  .app-header h1 {
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .app-header p {
    font-size: 14px;
    opacity: 0.95;
    margin: 0;
  }

  /* Search Bar - Sticky at top */
  .search-container {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: white;
    padding: 12px 15px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    z-index: 1000;
    border-bottom: 2px solid #667eea;
  }

  .search-wrapper {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .search-input-wrapper {
    position: relative;
    flex: 1;
  }

  .total-counter-badge {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 10px 16px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 700;
    white-space: nowrap;
    box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
    min-width: 50px;
    text-align: center;
    transition: all 0.3s ease;
  }

  .total-counter-badge.has-items {
    background: linear-gradient(135deg, #25d366 0%, #128c7e 100%);
    box-shadow: 0 2px 8px rgba(37, 211, 102, 0.4);
  }

  .search-input {
    border: 2px solid #e9ecef;
    border-radius: 10px;
    padding: 10px 15px 10px 40px;
    font-size: 14px;
    background: white;
    box-shadow: none;
    transition: all 0.3s ease;
  }

  .search-input:focus {
    border-color: #667eea;
    box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.15);
  }

  .search-icon {
    position: absolute;
    left: 15px;
    top: 50%;
    transform: translateY(-50%);
    color: #667eea;
    font-size: 16px;
  }

  .section-card {
    background: white;
    border-radius: 15px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.08);
    margin-bottom: 20px;
    overflow: hidden;
    transition: all 0.3s ease;
  }

  .section-card:hover {
    box-shadow: 0 8px 30px rgba(0,0,0,0.12);
    transform: translateY(-2px);
  }

  .section-card.hidden {
    display: none;
  }

  .section-header {
    padding: 18px 20px;
    cursor: pointer;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border-bottom: 2px solid #dee2e6;
    transition: all 0.3s ease;
  }

  .section-header:hover {
    background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);
  }

  .section-header.kirana-header {
    background: linear-gradient(135deg, #fff5e6 0%, #ffe0b2 100%);
    border-bottom: 2px solid #ff9800;
  }

  .section-title {
    font-size: 18px;
    font-weight: 700;
    margin: 0;
    display: flex;
    align-items: center;
    gap: 10px;
    color: #2c3e50;
  }

  .section-meta {
    font-size: 13px;
    color: #6c757d;
    margin-top: 4px;
  }

  .counter-badge {
    font-size: 14px;
    font-weight: 600;
    padding: 8px 16px;
    border-radius: 50px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);
    transition: all 0.3s ease;
  }

  .counter-badge.has-items {
    background: linear-gradient(135deg, #25d366 0%, #128c7e 100%);
    box-shadow: 0 3px 10px rgba(37, 211, 102, 0.4);
  }

  .chevron-icon {
    transition: transform 0.3s ease;
    font-size: 20px;
    color: #495057;
  }

  .chevron-icon.rotated {
    transform: rotate(180deg);
  }

  .section-body {
    padding: 15px;
    background: #fafbfc;
  }

  .item-row {
    background: white;
    padding: 15px;
    margin-bottom: 10px;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    transition: all 0.2s ease;
    cursor: pointer;
    user-select: none;
  }

  .item-row:hover {
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    transform: translateX(5px);
    background: #f8f9fa;
  }

  .item-row:active {
    transform: scale(0.98);
  }

  .item-row.checked {
    background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
    border-left: 4px solid #28a745;
  }

  .item-row.hidden {
    display: none !important;
  }

  .sr-number {
    font-size: 14px;
    font-weight: 600;
    color: #6c757d;
    min-width: 35px;
    text-align: center;
  }

  .item-name {
    font-size: 15px;
    font-weight: 500;
    color: #2c3e50;
    flex: 1;
  }

  .item-name-marathi {
    font-size: 13px;
    color: #6c757d;
    font-style: italic;
    margin-top: 2px;
  }

  .form-check-input {
    width: 24px;
    height: 24px;
    cursor: pointer;
    border: 2px solid #ced4da;
  }

  .form-check-input:checked {
    background-color: #28a745;
    border-color: #28a745;
  }

  .qty-input {
    border: 2px solid #e9ecef;
    border-radius: 10px;
    padding: 10px 12px;
    font-size: 14px;
    transition: all 0.3s ease;
  }

  .qty-input:focus {
    border-color: #667eea;
    box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
  }

  /* Delete button for custom items */
  .delete-btn {
    background: #dc3545;
    border: none;
    color: white;
    width: 32px;
    height: 32px;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .delete-btn:hover {
    background: #c82333;
    transform: scale(1.1);
  }

  /* Add Item Button */
  .add-item-btn {
    background: var(--success-gradient);
    border: none;
    color: white;
    padding: 12px 20px;
    border-radius: 10px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 10px;
    width: 100%;
    justify-content: center;
  }

  .add-item-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(17, 153, 142, 0.3);
  }

  /* Fixed Footer - Compact Design */
  .footer-fixed {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: white;
    padding: 8px 15px;
    box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
    z-index: 1000;
    border-top: 2px solid #667eea;
    transition: transform 0.3s ease, opacity 0.3s ease;
  }

  .footer-fixed.hidden {
    transform: translateY(100%);
    opacity: 0;
    pointer-events: none;
  }

  .footer-row {
    display: flex;
    gap: 6px;
    align-items: center;
  }

  .wa-input {
    border: 2px solid #e9ecef;
    border-radius: 8px;
    padding: 9px 10px;
    font-size: 13px;
    transition: all 0.3s ease;
    min-width: 0;
  }

  .wa-input:focus {
    border-color: #25d366;
    box-shadow: 0 0 0 0.2rem rgba(37, 211, 102, 0.15);
  }

  .share-btn {
    background: linear-gradient(135deg, #25d366 0%, #128c7e 100%);
    border: none;
    padding: 9px 14px;
    border-radius: 8px;
    color: white;
    font-weight: 700;
    font-size: 13px;
    box-shadow: 0 2px 8px rgba(37, 211, 102, 0.3);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 5px;
    white-space: nowrap;
    flex-shrink: 0;
  }

  .share-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(37, 211, 102, 0.4);
  }

  .share-btn:active {
    transform: translateY(0);
  }

  /* Scrollbar styling */
  ::-webkit-scrollbar {
    width: 8px;
  }

  ::-webkit-scrollbar-track {
    background: #f1f1f1;
  }

  ::-webkit-scrollbar-thumb {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 10px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
  }

  /* Empty state */
  .empty-state {
    text-align: center;
    padding: 30px;
    color: #6c757d;
  }

  .empty-state i {
    font-size: 48px;
    opacity: 0.5;
    margin-bottom: 15px;
  }

  /* No results message */
  .no-results {
    text-align: center;
    padding: 40px 20px;
    color: #6c757d;
  }

  .no-results i {
    font-size: 60px;
    opacity: 0.3;
    margin-bottom: 15px;
  }

  /* Animations */
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .section-card {
    animation: fadeIn 0.5s ease forwards;
  }

  /* Mobile optimizations */
  @media (max-width: 576px) {
    body {
      padding-top: 65px;
      padding-bottom: 55px;
    }

    .app-header h1 {
      font-size: 20px;
    }
    
    .section-title {
      font-size: 16px;
    }
    
    .item-name {
      font-size: 14px;
    }
    
    .qty-input {
      font-size: 13px;
      padding: 8px 10px;
      width: 90px !important;
    }
    
    .share-btn {
      padding: 9px 10px;
      font-size: 13px;
      min-width: 50px;
    }

    .share-btn i {
      font-size: 18px;
    }

    .item-row {
      padding: 12px;
    }

    .sr-number {
      min-width: 28px;
      font-size: 13px;
    }

    .search-container {
      padding: 10px 12px;
    }

    .search-wrapper {
      gap: 8px;
    }

    .search-input {
      padding: 8px 12px 8px 35px;
      font-size: 13px;
    }

    .search-icon {
      left: 12px;
      font-size: 14px;
    }

    .total-counter-badge {
      padding: 8px 12px;
      font-size: 13px;
      min-width: 40px;
    }

    .counter-badge {
      font-size: 13px;
      padding: 6px 12px;
    }

    .wa-input {
      padding: 8px 8px;
      font-size: 12px;
    }

    .footer-fixed {
      padding: 6px 10px;
    }

    .footer-row {
      gap: 4px;
    }

    #userName::placeholder,
    #waNumber::placeholder {
      font-size: 11px;
    }
  }

  /* Extra small screens - icon only button */
  @media (max-width: 400px) {
    .share-btn {
      padding: 9px 8px;
      min-width: 45px;
    }
  }
</style>
</head>
<body>

<!-- Header -->
<div class="app-header">
  <div class="container">
    <h1>
      <i class="bi bi-cart-check-fill"></i>
      Grocery & Kirana Checklist
    </h1>
    <p>
      <i class="bi bi-phone-fill"></i>
      ‡§µ‡§∏‡•ç‡§§‡•Ç ‡§®‡§ø‡§µ‡§°‡§æ, ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£ ‡§≠‡§∞‡§æ ‡§Ü‡§£‡§ø ‡§Ø‡§æ‡§¶‡•Ä ‡§µ‡•ç‡§π‡•â‡§ü‡•ç‡§∏‡•≤‡§™ ‡§µ‡§∞ ‡§∂‡•á‡§Ö‡§∞ ‡§ï‡§∞‡§æ!
    </p>
  </div>
</div>

<!-- Search Bar - Fixed at Top -->
<div class="search-container">
  <div class="container">
    <div class="search-wrapper">
      <div class="search-input-wrapper">
        <i class="bi bi-search search-icon"></i>
        <input 
          type="text" 
          id="searchInput" 
          class="form-control search-input" 
          placeholder="Search items... (e.g., Sugar, ‡§∏‡§æ‡§ñ‡§∞, Oil, ‡§§‡•á‡§≤)"
        />
      </div>
      <div class="total-counter-badge" id="totalCounter">
        0
      </div>
    </div>
  </div>
</div>

<!-- Main Content -->
<div class="container">
  <!-- No Results Message -->
  <div id="noResults" class="no-results" style="display: none;">
    <i class="bi bi-search"></i>
    <h5>‡§ï‡•ã‡§£‡§§‡•Ä‡§π‡•Ä ‡§µ‡§∏‡•ç‡§§‡•Ç ‡§∏‡§æ‡§™‡§°‡§≤‡•Ä ‡§®‡§æ‡§π‡•Ä</h5>
    <p>‡§¶‡•Å‡§∏‡§∞‡§æ ‡§∂‡§¨‡•ç‡§¶ ‡§µ‡§æ‡§™‡§∞‡•Ç‡§® ‡§™‡§π‡§æ</p>
  </div>

  <div id="listWrap">
    <!-- Sections will be injected by JavaScript -->
  </div>
</div>

<!-- Fixed Footer -->
<div class="footer-fixed" id="footerFixed">
  <div class="container">
    <div class="footer-row">
      <input 
        type="text" 
        id="userName" 
        class="form-control wa-input" 
        placeholder="‡§®‡§æ‡§µ ‡§ü‡§æ‡§ï‡§æ (‡§ó‡•ç‡§∞‡§æ‡§π‡§ï‡§æ‡§ö‡•á) ‡§™‡§∞‡•ç‡§Ø‡§æ‡§Ø‡•Ä" 
        style="flex: 1.2;"
      />
      <input 
        type="tel" 
        id="waNumber" 
        class="form-control wa-input" 
        placeholder="‡§µ‡•ç‡§π‡•â‡§ü‡•ç‡§∏‡•≤‡§™ ‡§®‡§Ç‡§¨‡§∞" 
        inputmode="numeric"
        style="flex: 1;"
      />
      <button class="share-btn" id="shareBtn">
        <i class="bi bi-whatsapp"></i>
        <span class="d-none d-sm-inline">‡§∂‡•á‡§Ö‡§∞</span>
      </button>
    </div>
  </div>
</div>

<!-- Bootstrap JS Bundle (includes Popper) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
(function(){
  // Comprehensive Kirana and Grocery Data with Marathi translations
  const SECTIONS = [
    {
      id: 'sweeteners',
      title: 'Sweeteners & Beverages (‡§ó‡•ã‡§° ‡§™‡§¶‡§æ‡§∞‡•ç‡§• ‡§Ü‡§£‡§ø ‡§™‡•á‡§Ø)',
      icon: 'bi-cup-hot-fill',
      items: [
        {name: 'Sugar', marathi: '‡§∏‡§æ‡§ñ‡§∞'},
        {name: 'Jaggery', marathi: '‡§ó‡•Ç‡§≥'},
        {name: 'Honey', marathi: '‡§Æ‡§ß'},
        {name: 'Tea Powder/Leaves', marathi: '‡§ö‡§π‡§æ ‡§™‡§æ‡§µ‡§°‡§∞'},
        {name: 'Coffee', marathi: '‡§ï‡•â‡§´‡•Ä'},
        {name: 'Milk Powder', marathi: '‡§¶‡•Ç‡§ß ‡§™‡§æ‡§µ‡§°‡§∞'},
        {name: 'Juice (Ready-made)', marathi: '‡§∞‡§∏ (‡§∞‡•á‡§°‡•Ä‡§Æ‡•á‡§°)'},
        {name: 'Biscuits/Cookies', marathi: '‡§¨‡§ø‡§∏‡•ç‡§ï‡§ø‡§ü‡•á'},
        {name: 'Jam / Jelly', marathi: '‡§ú‡§æ‡§Æ / ‡§ú‡•á‡§≤‡•Ä'},
        {name: 'Dates (Khajur)', marathi: '‡§∂‡•á‡§ï‡§ü‡§æ'},
        {name: 'Raisins (Manuke)', marathi: '‡§Æ‡§®‡•Å‡§ï‡•á'}
      ]
    },
    {
      id: 'oils',
      title: 'Oil, Fats & Pickles (‡§§‡•á‡§≤, ‡§§‡•Ç‡§™ ‡§Ü‡§£‡§ø ‡§≤‡•ã‡§£‡§ö‡•á)',
      icon: 'bi-droplet-fill',
      items: [
        {name: 'Cooking Oil (Groundnut/Sunflower)', marathi: '‡§ñ‡§æ‡§£‡•ç‡§Ø‡§æ‡§ö‡•á ‡§§‡•á‡§≤ (‡§∂‡•á‡§Ç‡§ó‡§¶‡§æ‡§£‡§æ/‡§∏‡•Ç‡§∞‡•ç‡§Ø‡§´‡•Ç‡§≤)'},
        {name: 'Ghee', marathi: '‡§§‡•Ç‡§™'},
        {name: 'Mustard Oil', marathi: '‡§Æ‡•ã‡§π‡§∞‡•Ä‡§ö‡•á ‡§§‡•á‡§≤'},
        {name: 'Coconut Oil', marathi: '‡§®‡§æ‡§∞‡§≥‡§æ‡§ö‡•á ‡§§‡•á‡§≤'},
        {name: 'Butter', marathi: '‡§≤‡•ã‡§£‡•Ä'},
        {name: 'Pickles (Mango/Lemon)', marathi: '‡§≤‡•ã‡§£‡§ö‡•á (‡§Ü‡§Ç‡§¨‡§æ/‡§≤‡§ø‡§Ç‡§¨‡•Ç)'},
        {name: 'Papad', marathi: '‡§™‡§æ‡§™‡§°'},
        {name: 'Vermicelli (Sevaiya)', marathi: '‡§∂‡•á‡§µ‡§Ø‡§æ'}
      ]
    },
    {
      id: 'grains',
      title: 'Grains & Flours (‡§Ö‡§®‡•ç‡§®‡§ß‡§æ‡§®‡•ç‡§Ø‡•á ‡§Ü‡§£‡§ø ‡§™‡•Ä‡§†)',
      icon: 'bi-shop',
      items: [
        {name: 'Rice (Regular / Basmati)', marathi: '‡§§‡§æ‡§Ç‡§¶‡•Ç‡§≥ (‡§∞‡•ã‡§ú‡§ö‡§æ / ‡§¨‡§æ‡§∏‡§Æ‡§§‡•Ä)'},
        {name: 'Wheat', marathi: '‡§ó‡§π‡•Ç'},
        {name: 'Jowar (Sorghum)', marathi: '‡§ú‡•ç‡§µ‡§æ‡§∞‡•Ä'},
        {name: 'Bajra (Pearl Millet)', marathi: '‡§¨‡§æ‡§ú‡§∞‡•Ä'},
        {name: 'Ragi (Finger Millet)', marathi: '‡§®‡§æ‡§ö‡§£‡•Ä'},
        {name: 'Wheat Flour (Atta)', marathi: '‡§ó‡§µ‡•ç‡§π‡§æ‡§ö‡•á ‡§™‡•Ä‡§†'},
        {name: 'Maida (Refined Flour)', marathi: '‡§Æ‡•à‡§¶‡§æ'},
        {name: 'Rawa / Suji (Semolina)', marathi: '‡§∞‡§µ‡§æ / ‡§∏‡•Ç‡§ú‡•Ä'},
        {name: 'Besan (Gram Flour)', marathi: '‡§¨‡•á‡§∏‡§®'},
        {name: 'Rice Flour', marathi: '‡§§‡§æ‡§Ç‡§¶‡§≥‡§æ‡§ö‡•á ‡§™‡•Ä‡§†'},
        {name: 'Sabudana (Tapioca Pearls)', marathi: '‡§∏‡§æ‡§¨‡•Ç‡§¶‡§æ‡§£‡§æ'},
        {name: 'Poha (Flattened Rice)', marathi: '‡§™‡•ã‡§π‡•á'},
        {name: 'Kurmure (Puffed Rice)', marathi: '‡§ï‡•Å‡§∞‡§Æ‡•Å‡§∞‡•á / ‡§ö‡•Å‡§∞‡§Æ‡•Å‡§∞‡•á'}
      ]
    },
    {
      id: 'pulses',
      title: 'Pulses & Legumes (‡§°‡§æ‡§≥‡•Ä ‡§Ü‡§£‡§ø ‡§ï‡§°‡§ß‡§æ‡§®‡•ç‡§Ø‡•á)',
      icon: 'bi-basket3-fill',
      items: [
        {name: 'Toor Dal (Arhar)', marathi: '‡§§‡•Ç‡§∞ ‡§°‡§æ‡§≥'},
        {name: 'Moong Dal', marathi: '‡§Æ‡•Ç‡§ó ‡§°‡§æ‡§≥'},
        {name: 'Masoor Dal', marathi: '‡§Æ‡§∏‡•Ç‡§∞ ‡§°‡§æ‡§≥'},
        {name: 'Chana Dal', marathi: '‡§ö‡§£‡§æ ‡§°‡§æ‡§≥'},
        {name: 'Urad Dal', marathi: '‡§â‡§°‡•Ä‡§¶ ‡§°‡§æ‡§≥'},
        {name: 'Whole Moong', marathi: '‡§Ü‡§ñ‡•ç‡§ñ‡•á ‡§Æ‡•Ç‡§ó'},
        {name: 'Whole Urad', marathi: '‡§ï‡§æ‡§≥‡•á ‡§â‡§°‡•Ä‡§¶'},
        {name: 'Chhole (Chickpeas)', marathi: '‡§π‡§∞‡§≠‡§∞‡•á / ‡§ö‡§£‡•á'},
        {name: 'Rajma (Kidney Beans)', marathi: '‡§∞‡§æ‡§ú‡§Æ‡§æ'},
        {name: 'Peanuts', marathi: '‡§∂‡•á‡§Ç‡§ó‡§¶‡§æ‡§£‡•á'}
      ]
    },
    {
      id: 'spices',
      title: 'Spices & Seasonings (‡§Æ‡§∏‡§æ‡§≤‡•á)',
      icon: 'bi-fire',
      items: [
        {name: 'Salt', marathi: '‡§Æ‡•Ä‡§†'},
        {name: 'Turmeric Powder', marathi: '‡§π‡§≥‡§¶ ‡§™‡§æ‡§µ‡§°‡§∞'},
        {name: 'Red Chili Powder', marathi: '‡§≤‡§æ‡§≤ ‡§§‡§ø‡§ñ‡§ü / ‡§Æ‡§ø‡§∞‡§ö‡•Ä ‡§™‡§æ‡§µ‡§°‡§∞'},
        {name: 'Coriander Powder', marathi: '‡§ß‡§®‡•á ‡§™‡§æ‡§µ‡§°‡§∞'},
        {name: 'Cumin Seeds', marathi: '‡§ú‡•Ä‡§∞‡§æ / ‡§ú‡§ø‡§∞‡•á'},
        {name: 'Mustard Seeds', marathi: '‡§Æ‡•ã‡§π‡§∞‡•Ä'},
        {name: 'Hing (Asafoetida)', marathi: '‡§π‡§ø‡§Ç‡§ó'},
        {name: 'Garam Masala', marathi: '‡§ó‡§∞‡§Æ ‡§Æ‡§∏‡§æ‡§≤‡§æ'},
        {name: 'Ginger-Garlic Paste', marathi: '‡§Ü‡§≤‡•á-‡§≤‡§∏‡•Ç‡§£ ‡§™‡•á‡§∏‡•ç‡§ü'},
        {name: 'Kanda Lasun Masala', marathi: '‡§ï‡§æ‡§Ç‡§¶‡§æ-‡§≤‡§∏‡•Ç‡§£ ‡§Æ‡§∏‡§æ‡§≤‡§æ'},
        {name: 'Black Salt', marathi: '‡§ï‡§æ‡§≥ ‡§Æ‡•Ä‡§†'},
        {name: 'Amchur Powder', marathi: '‡§Ü‡§Æ‡§ö‡•Ç‡§∞ ‡§™‡§æ‡§µ‡§°‡§∞'},
        {name: 'Cashews', marathi: '‡§ï‡§æ‡§ú‡•Ç'},
        {name: 'Almonds (Badam)', marathi: '‡§¨‡§¶‡§æ‡§Æ'},
        {name: 'Dry Coconut (Copra)', marathi: '‡§ñ‡•ã‡§¨‡§∞‡•á (‡§∏‡•Å‡§ï‡•á)'}
      ]
    },
    {
      id: 'vegetables',
      title: 'Vegetables (‡§≠‡§æ‡§ú‡•ç‡§Ø‡§æ)',
      icon: 'bi-basket2-fill',
      items: [
        {name: 'Potato', marathi: '‡§¨‡§ü‡§æ‡§ü‡§æ'},
        {name: 'Onion', marathi: '‡§ï‡§æ‡§Ç‡§¶‡§æ'},
        {name: 'Tomato', marathi: '‡§ü‡•ã‡§Æ‡•Ö‡§ü‡•ã'},
        {name: 'Green Chillies', marathi: '‡§π‡§ø‡§∞‡§µ‡•ç‡§Ø‡§æ ‡§Æ‡§ø‡§∞‡§ö‡•ç‡§Ø‡§æ'},
        {name: 'Coriander (Dhania)', marathi: '‡§ï‡•ã‡§•‡§ø‡§Ç‡§¨‡•Ä‡§∞'},
        {name: 'Ginger', marathi: '‡§Ü‡§≤‡§Ç'},
        {name: 'Garlic', marathi: '‡§≤‡§∏‡•Ç‡§£'},
        {name: 'Cucumber', marathi: '‡§ï‡§æ‡§ï‡§°‡•Ä'},
        {name: 'Carrot', marathi: '‡§ó‡§æ‡§ú‡§∞'},
        {name: 'Beetroot', marathi: '‡§¨‡•Ä‡§ü'},
        {name: 'Cabbage', marathi: '‡§ï‡•ã‡§¨‡•Ä'},
        {name: 'Cauliflower', marathi: '‡§´‡•ç‡§≤‡•â‡§µ‡§∞'},
        {name: 'Ladyfinger (Bhindi)', marathi: '‡§≠‡•á‡§Ç‡§°‡•Ä'},
        {name: 'Brinjal (Eggplant)', marathi: '‡§µ‡§æ‡§Ç‡§ó‡•Ä'},
        {name: 'Spinach (Palak)', marathi: '‡§™‡§æ‡§≤‡§ï'},
        {name: 'Bell Pepper (Capsicum)', marathi: '‡§∂‡§ø‡§Æ‡§≤‡§æ ‡§Æ‡§ø‡§∞‡§ö‡•Ä'},
        {name: 'Peas', marathi: '‡§µ‡§æ‡§ü‡§æ‡§£‡•á'},
        {name: 'Green Beans', marathi: '‡§ò‡•á‡§µ‡§°‡§æ'},
        {name: 'Radish', marathi: '‡§Æ‡•Å‡§≥‡§æ'},
        {name: 'Bottle Gourd (Lauki)', marathi: '‡§¶‡•Ç‡§ß‡•Ä / ‡§≤‡•å‡§ï‡•Ä'}
      ]
    },
    {
      id: 'fruits',
      title: 'Fruits (‡§´‡§≥‡•á)',
      icon: 'bi-apple',
      items: [
        {name: 'Banana', marathi: '‡§ï‡•á‡§≥‡•Ä'},
        {name: 'Apple', marathi: '‡§∏‡§´‡§∞‡§ö‡§Ç‡§¶'},
        {name: 'Orange', marathi: '‡§∏‡§Ç‡§§‡•ç‡§∞‡§æ'},
        {name: 'Mango (seasonal)', marathi: '‡§Ü‡§Ç‡§¨‡§æ'},
        {name: 'Grapes', marathi: '‡§¶‡•ç‡§∞‡§æ‡§ï‡•ç‡§∑‡•á'},
        {name: 'Pomegranate', marathi: '‡§°‡§æ‡§≥‡§ø‡§Ç‡§¨'},
        {name: 'Papaya', marathi: '‡§™‡§™‡§à'},
        {name: 'Watermelon', marathi: '‡§ü‡§∞‡§¨‡•Ç‡§ú'},
        {name: 'Pineapple', marathi: '‡§Ö‡§®‡§®‡§∏'},
        {name: 'Guava', marathi: '‡§™‡•á‡§∞‡•Ç'},
        {name: 'Lemon / Lime', marathi: '‡§≤‡§ø‡§Ç‡§¨‡•Ç'},
        {name: 'Kiwi', marathi: '‡§ï‡§ø‡§µ‡•Ä'},
        {name: 'Strawberries', marathi: '‡§∏‡•ç‡§ü‡•ç‡§∞‡•â‡§¨‡•á‡§∞‡•Ä'}
      ]
    },
    {
      id: 'dairy',
      title: 'Dairy & Bakery (‡§¶‡•Å‡§ó‡•ç‡§ß‡§ú‡§®‡•ç‡§Ø ‡§™‡§¶‡§æ‡§∞‡•ç‡§•)',
      icon: 'bi-cup-straw',
      items: [
        {name: 'Milk (fresh)', marathi: '‡§¶‡•Ç‡§ß (‡§§‡§æ‡§ú‡•á)'},
        {name: 'Curd / Yogurt', marathi: '‡§¶‡§π‡•Ä'},
        {name: 'Paneer', marathi: '‡§™‡§®‡•Ä‡§∞'},
        {name: 'Butter', marathi: '‡§≤‡•ã‡§£‡•Ä'},
        {name: 'Cheese', marathi: '‡§ö‡•Ä‡§ú'},
        {name: 'Eggs', marathi: '‡§Ö‡§Ç‡§°‡•Ä'},
        {name: 'Buns / Pav', marathi: '‡§™‡§æ‡§µ'},
        {name: 'Cake / Pastry', marathi: '‡§ï‡•á‡§ï'},
        {name: 'Cream', marathi: '‡§Æ‡§≤‡§à'},
        {name: 'Buttermilk', marathi: '‡§§‡§æ‡§ï'}
      ]
    },
    {
      id: 'snacks',
      title: 'Snacks & Beverages (‡§∏‡•ç‡§®‡•Ö‡§ï‡•ç‡§∏)',
      icon: 'bi-bag-fill',
      items: [
        {name: 'Chips', marathi: '‡§ö‡§ø‡§™‡•ç‡§∏'},
        {name: 'Namkeen', marathi: '‡§®‡§Æ‡§ï‡•Ä‡§®'},
        {name: 'Sweets / Mithai', marathi: '‡§Æ‡§ø‡§†‡§æ‡§à'},
        {name: 'Cold Drinks', marathi: '‡§ï‡•ã‡§≤‡•ç‡§° ‡§°‡•ç‡§∞‡§ø‡§Ç‡§ï'},
        {name: 'Juice (Tetra)', marathi: '‡§∞‡§∏ (‡§ü‡•á‡§ü‡•ç‡§∞‡§æ ‡§™‡•Ö‡§ï)'},
        {name: 'Energy Drinks', marathi: '‡§è‡§®‡§∞‡•ç‡§ú‡•Ä ‡§°‡•ç‡§∞‡§ø‡§Ç‡§ï'},
        {name: 'Mineral Water', marathi: '‡§™‡§æ‡§£‡•ç‡§Ø‡§æ‡§ö‡•Ä ‡§¨‡§æ‡§ü‡§≤‡•Ä'},
        {name: 'Chocolates', marathi: '‡§ö‡•â‡§ï‡§≤‡•á‡§ü'},
        {name: 'Cookies', marathi: '‡§ï‡•Å‡§ï‡•Ä‡§ú'},
        {name: 'Ice Cream', marathi: '‡§Ü‡§à‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§Æ'}
      ]
    },
    {
      id: 'cleaning',
      title: 'Cleaning & Household (‡§ò‡§∞‡§ó‡•Å‡§§‡•Ä)',
      icon: 'bi-house-fill',
      items: [
        {name: 'Detergent Powder/Liquid', marathi: '‡§ï‡§™‡§°‡•á ‡§ß‡•Å‡§£‡•ç‡§Ø‡§æ‡§ö‡•Ä ‡§™‡§æ‡§µ‡§°‡§∞/‡§°‡§ø‡§ü‡§∞‡•ç‡§ú‡§Ç‡§ü'},
        {name: 'Dishwashing Liquid', marathi: '‡§≠‡§æ‡§Ç‡§°‡•Ä ‡§ò‡§æ‡§∏‡§£‡•ç‡§Ø‡§æ‡§ö‡§æ ‡§∏‡§æ‡§¨‡§£/‡§≤‡§ø‡§ï‡•ç‡§µ‡§ø‡§°'},
        {name: 'Floor Cleaner', marathi: '‡§´‡§∞‡§∂‡•Ä ‡§™‡•Å‡§∏‡§£‡•ç‡§Ø‡§æ‡§ö‡•á ‡§≤‡§ø‡§ï‡•ç‡§µ‡§ø‡§°'},
        {name: 'Toilet Cleaner', marathi: '‡§ü‡•â‡§Ø‡§≤‡•á‡§ü ‡§ï‡•ç‡§≤‡•Ä‡§®‡§∞'},
        {name: 'Incense Sticks (Agarbatti)', marathi: '‡§Ö‡§ó‡§∞‡§¨‡§§‡•ç‡§§‡•Ä'},
        {name: 'Matchbox', marathi: '‡§ï‡§æ‡§°‡•ç‡§Ø‡§æ‡§™‡•á‡§ü‡•ç‡§ü‡•Ä'},
        {name: 'Paper Napkins', marathi: '‡§ï‡§æ‡§ó‡§¶‡•Ä ‡§®‡•Ö‡§™‡§ï‡§ø‡§®'},
        {name: 'Garbage Bags', marathi: '‡§ï‡§ö‡§±‡•ç‡§Ø‡§æ‡§ö‡•Ä ‡§™‡§ø‡§∂‡§µ‡•Ä'},
        {name: 'Sanitary Napkins', marathi: '‡§∏‡•Ö‡§®‡§ø‡§ü‡§∞‡•Ä ‡§™‡•Ö‡§°'},
        {name: 'Mop / Broom', marathi: '‡§™‡•ã‡§ö‡§æ / ‡§ù‡§æ‡§°‡•Ç'}
      ]
    },
    {
      id: 'toiletries',
      title: 'Personal Care (‡§µ‡•à‡§Ø‡§ï‡•ç‡§§‡§ø‡§ï ‡§ï‡§æ‡§≥‡§ú‡•Ä)',
      icon: 'bi-scissors',
      items: [
        {name: 'Bathing Soap', marathi: '‡§Ö‡§Ç‡§ò‡•ã‡§≥‡•Ä‡§ö‡§æ ‡§∏‡§æ‡§¨‡§£'},
        {name: 'Toothpaste', marathi: '‡§ü‡•Ç‡§•‡§™‡•á‡§∏‡•ç‡§ü'},
        {name: 'Toothbrush', marathi: '‡§ü‡•Ç‡§•‡§¨‡•ç‡§∞‡§∂'},
        {name: 'Hair Oil', marathi: '‡§π‡•á‡§Ö‡§∞ ‡§ë‡§á‡§≤ / ‡§§‡•á‡§≤'},
        {name: 'Shampoo', marathi: '‡§∂‡•Ö‡§Æ‡•ç‡§™‡•Ç'},
        {name: 'Conditioner', marathi: '‡§ï‡§Ç‡§°‡§ø‡§∂‡§®‡§∞'},
        {name: 'Body Lotion', marathi: '‡§¨‡•â‡§°‡•Ä ‡§≤‡•ã‡§∂‡§®'},
        {name: 'Hand Wash', marathi: '‡§π‡§Å‡§° ‡§µ‡•â‡§∂'},
        {name: 'Shaving Cream', marathi: '‡§∂‡•á‡§µ‡•ç‡§π‡§ø‡§Ç‡§ó ‡§ï‡•ç‡§∞‡•Ä‡§Æ'},
        {name: 'Deodorant', marathi: '‡§°‡§ø‡§ì‡§°‡§∞‡§Ç‡§ü'},
        {name: 'Facewash', marathi: '‡§´‡•á‡§∏‡§µ‡•â‡§∂'},
        {name: 'Moisturizer', marathi: '‡§Æ‡•â‡§á‡§∂‡•ç‡§ö‡§∞‡§æ‡§Ø‡§ù‡§∞'},
        {name: 'Sunscreen', marathi: '‡§∏‡§®‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§®'},
        {name: 'Tissues', marathi: '‡§ü‡§ø‡§∂‡•ç‡§Ø‡•Ç'},
        {name: 'Wet Wipes', marathi: '‡§µ‡•á‡§ü ‡§µ‡§æ‡§à‡§™‡•ç‡§∏'}
      ]
    },
    {
      id: 'misc',
      title: 'Miscellaneous (‡§á‡§§‡§∞)',
      icon: 'bi-three-dots',
      items: [
        {name: 'Lighters / Matches', marathi: '‡§≤‡§æ‡§Ø‡§ü‡§∞ / ‡§Æ‡§æ‡§ö‡§ø‡§∏'},
        {name: 'Battery (AA / AAA)', marathi: '‡§¨‡•Ö‡§ü‡§∞‡•Ä'},
        {name: 'Aluminium Foil', marathi: '‡§Ö‡§≤‡•ç‡§Ø‡•Å‡§Æ‡§ø‡§®‡§ø‡§Ø‡§Æ ‡§´‡•â‡§á‡§≤'},
        {name: 'Cling Film', marathi: '‡§ï‡•ç‡§≤‡§ø‡§Ç‡§ó ‡§´‡§ø‡§≤‡•ç‡§Æ'},
        {name: 'Tea Strainer', marathi: '‡§ö‡§π‡§æ‡§ö‡•Ä ‡§ö‡§æ‡§≥‡§£‡•Ä'},
        {name: 'Candles', marathi: '‡§Æ‡•á‡§£‡§¨‡§§‡•ç‡§§‡•ç‡§Ø‡§æ'},
        {name: 'Mosquito Repellent', marathi: '‡§Æ‡§ö‡•ç‡§õ‡§∞ ‡§≠‡§ó‡§æ‡§®‡•á'},
        {name: 'Instant Noodles', marathi: '‡§Æ‡•Ö‡§ó‡•Ä / ‡§®‡•Ç‡§°‡§≤‡•ç‡§∏'}
      ]
    }
  ];

  const listWrap = document.getElementById('listWrap');
  let customItemCounter = 0;
  const footer = document.getElementById('footerFixed');

  // Auto-hide footer when typing (especially for mobile keyboard)
  function setupFooterAutoHide() {
    // Hide footer when any quantity input is focused
    document.addEventListener('focusin', (e) => {
      if (e.target.classList.contains('qty-input')) {
        footer.classList.add('hidden');
      }
    });

    // Show footer when focus leaves quantity input
    document.addEventListener('focusout', (e) => {
      if (e.target.classList.contains('qty-input')) {
        setTimeout(() => {
          footer.classList.remove('hidden');
        }, 100);
      }
    });
  }

  setupFooterAutoHide();

  // LocalStorage functions to persist data
  function saveToLocalStorage() {
    const data = {
      selections: {},
      customItems: {}
    };

    // Save all sections
    document.querySelectorAll('.section-card').forEach(sec => {
      const sectionId = sec.dataset.id;
      data.selections[sectionId] = [];
      data.customItems[sectionId] = [];

      sec.querySelectorAll('.item-row').forEach((row, idx) => {
        const checkbox = row.querySelector('.item-checkbox');
        const qtyInput = row.querySelector('.qty-input');
        const isCustom = row.dataset.isCustom === 'true';

        const itemData = {
          checked: checkbox.checked,
          quantity: qtyInput.value,
          index: idx
        };

        // If it's a custom item, save the name too
        if (isCustom) {
          const nameDiv = row.querySelector('.item-name');
          const marathiDiv = nameDiv.querySelector('.item-name-marathi');
          const nameElement = nameDiv.cloneNode(true);
          if (marathiDiv) marathiDiv.remove();
          itemData.name = nameElement.textContent.trim();
          data.customItems[sectionId].push(itemData);
        } else {
          data.selections[sectionId].push(itemData);
        }
      });
    });

    localStorage.setItem('groceryList', JSON.stringify(data));
  }

  function loadFromLocalStorage() {
    const saved = localStorage.getItem('groceryList');
    if (!saved) return null;
    try {
      return JSON.parse(saved);
    } catch (e) {
      return null;
    }
  }

  function restoreState(sectionEl, sectionId, savedData) {
    if (!savedData || !savedData.selections) return;

    const sectionData = savedData.selections[sectionId] || [];
    const customData = savedData.customItems[sectionId] || [];

    // Restore regular items
    sectionEl.querySelectorAll('.item-row').forEach((row, idx) => {
      if (row.dataset.isCustom === 'true') return; // Skip custom items for now
      
      const itemData = sectionData[idx];
      if (itemData) {
        const checkbox = row.querySelector('.item-checkbox');
        const qtyInput = row.querySelector('.qty-input');
        
        checkbox.checked = itemData.checked;
        qtyInput.value = itemData.quantity || '';
        
        if (itemData.checked) {
          row.classList.add('checked');
        }
      }
    });

    // Restore custom items
    const body = sectionEl.querySelector('.section-body');
    const addBtn = body.querySelector('.add-item-btn');
    
    customData.forEach((itemData, idx) => {
      const currentItemCount = body.querySelectorAll('.item-row').length;
      const customItem = {
        name: itemData.name,
        marathi: ''
      };
      const newRow = createItemRow(customItem, sectionId, currentItemCount, true);
      body.insertBefore(newRow, addBtn);
      
      // Set the state
      const checkbox = newRow.querySelector('.item-checkbox');
      const qtyInput = newRow.querySelector('.qty-input');
      checkbox.checked = itemData.checked;
      qtyInput.value = itemData.quantity || '';
      
      if (itemData.checked) {
        newRow.classList.add('checked');
      }
    });

    // Renumber all items
    renumberItems(body);
    updateCounter(sectionEl);
  }

  function createItemRow(itemData, sectionId, idx, isCustom = false) {
    const row = document.createElement('div');
    row.className = 'item-row d-flex align-items-center gap-2';
    row.dataset.itemIndex = idx;
    row.dataset.isCustom = isCustom;
    
    // Store searchable text (both English and Marathi)
    const searchableText = (itemData.name + ' ' + (itemData.marathi || '')).toLowerCase();
    row.dataset.itemName = searchableText;

    // Serial number
    const sr = document.createElement('div');
    sr.className = 'sr-number';
    sr.textContent = idx + 1;

    // Item name
    const nameDiv = document.createElement('div');
    nameDiv.className = 'item-name';
    nameDiv.innerHTML = itemData.name;
    if (itemData.marathi) {
      nameDiv.innerHTML += `<div class="item-name-marathi">${itemData.marathi}</div>`;
    }

    // Checkbox
    const checkDiv = document.createElement('div');
    checkDiv.className = 'form-check';
    const checkbox = document.createElement('input');
    checkbox.className = 'form-check-input item-checkbox';
    checkbox.type = 'checkbox';
    checkbox.id = sectionId + '-item-' + idx + (isCustom ? '-custom' : '');
    checkDiv.appendChild(checkbox);

    // Quantity input
    const qtyInput = document.createElement('input');
    qtyInput.type = 'text';
    qtyInput.className = 'form-control qty-input';
    qtyInput.placeholder = 'qty';
    qtyInput.style.width = '110px';

    row.appendChild(sr);
    row.appendChild(nameDiv);
    row.appendChild(checkDiv);
    row.appendChild(qtyInput);

    // Delete button for custom items
    if (isCustom) {
      const deleteBtn = document.createElement('button');
      deleteBtn.className = 'delete-btn';
      deleteBtn.innerHTML = '<i class="bi bi-trash-fill"></i>';
      deleteBtn.onclick = function(e) {
        e.stopPropagation();
        if (confirm('‡§π‡•Ä ‡§µ‡§∏‡•ç‡§§‡•Ç ‡§ï‡§æ‡§¢‡§æ‡§Ø‡§ö‡•Ä ‡§Ü‡§π‡•á ‡§ï‡§æ?')) {
          row.remove();
          updateCounter(row.closest('.section-card'));
          renumberItems(row.closest('.section-body'));
          saveToLocalStorage();
        }
      };
      row.appendChild(deleteBtn);
    }

    // Checkbox event
    checkbox.addEventListener('change', () => {
      if (checkbox.checked) {
        row.classList.add('checked');
        // Auto-focus on quantity input when checked
        setTimeout(() => {
          qtyInput.focus();
        }, 100);
      } else {
        row.classList.remove('checked');
      }
      updateCounter(row.closest('.section-card'));
      saveToLocalStorage();
    });

    // Make entire row clickable (except quantity input and delete button)
    row.addEventListener('click', (e) => {
      // Don't toggle if clicking on quantity input, delete button, or checkbox itself
      if (e.target === qtyInput || 
          e.target.closest('.delete-btn') || 
          e.target === checkbox) {
        return;
      }
      
      // Toggle checkbox
      checkbox.checked = !checkbox.checked;
      checkbox.dispatchEvent(new Event('change'));
    });

    // Prevent quantity input from triggering row click
    qtyInput.addEventListener('click', (e) => {
      e.stopPropagation();
    });

    // Save to localStorage when quantity changes
    qtyInput.addEventListener('input', () => {
      saveToLocalStorage();
    });

    return row;
  }

  function renumberItems(bodyElement) {
    const rows = bodyElement.querySelectorAll('.item-row');
    rows.forEach((row, idx) => {
      const srNum = row.querySelector('.sr-number');
      if (srNum) srNum.textContent = idx + 1;
      row.dataset.itemIndex = idx;
    });
  }

  function createSection(section, idx){
    const sec = document.createElement('div');
    sec.className = 'section-card';
    sec.dataset.id = section.id;
    sec.style.animationDelay = (idx * 0.1) + 's';

    // Header
    const header = document.createElement('div');
    header.className = 'section-header' + (section.id === 'sweeteners' ? ' kirana-header' : '');
    
    const headerRow = document.createElement('div');
    headerRow.className = 'd-flex justify-content-between align-items-center';

    const leftDiv = document.createElement('div');
    const title = document.createElement('h3');
    title.className = 'section-title';
    title.innerHTML = `<i class="bi ${section.icon}"></i> ${section.title}`;
    
    const meta = document.createElement('div');
    meta.className = 'section-meta';
    meta.textContent = section.items.length + ' ‡§µ‡§∏‡•ç‡§§‡•Ç';
    
    leftDiv.appendChild(title);
    leftDiv.appendChild(meta);

    const rightDiv = document.createElement('div');
    rightDiv.className = 'd-flex align-items-center gap-3';
    
    const counter = document.createElement('span');
    counter.className = 'counter-badge';
    counter.textContent = '0/' + section.items.length;
    
    const chevron = document.createElement('i');
    chevron.className = 'bi bi-chevron-down chevron-icon' + (idx === 0 ? ' rotated' : '');
    
    rightDiv.appendChild(counter);
    rightDiv.appendChild(chevron);

    headerRow.appendChild(leftDiv);
    headerRow.appendChild(rightDiv);
    header.appendChild(headerRow);

    // Body
    const body = document.createElement('div');
    body.className = 'section-body collapse' + (idx === 0 ? ' show' : '');
    body.id = 'collapse-' + section.id;

    // Items
    section.items.forEach((item, i) => {
      const row = createItemRow(item, section.id, i, false);
      body.appendChild(row);
    });

    // Add Custom Item Button
    const addBtn = document.createElement('button');
    addBtn.className = 'add-item-btn';
    addBtn.innerHTML = '<i class="bi bi-plus-circle-fill"></i> ‡§®‡§µ‡•Ä‡§® ‡§µ‡§∏‡•ç‡§§‡•Ç ‡§ü‡§æ‡§ï‡§æ';
    addBtn.onclick = function(e) {
      e.stopPropagation();
      const itemName = prompt('‡§µ‡§∏‡•ç‡§§‡•Ç‡§ö‡•á ‡§®‡§æ‡§µ ‡§ü‡§æ‡§ï‡§æ (‡§ï‡•ã‡§£‡§§‡•ç‡§Ø‡§æ‡§π‡•Ä ‡§≠‡§æ‡§∑‡•á‡§§):');
      if (itemName && itemName.trim() !== '') {
        const currentItemCount = body.querySelectorAll('.item-row').length;
        const customItem = {
          name: itemName.trim(),
          marathi: ''
        };
        const newRow = createItemRow(customItem, section.id, currentItemCount, true);
        body.insertBefore(newRow, addBtn);
        updateCounter(sec);
        renumberItems(body);
        saveToLocalStorage();
      }
    };
    body.appendChild(addBtn);

    sec.appendChild(header);
    sec.appendChild(body);

    // Toggle collapse
    header.style.cursor = 'pointer';
    header.addEventListener('click', () => {
      const bsCollapse = new bootstrap.Collapse(body, {
        toggle: true
      });
      chevron.classList.toggle('rotated');
    });

    return sec;
  }

  // Render all sections
  const savedData = loadFromLocalStorage();
  SECTIONS.forEach((s, idx) => {
    const secEl = createSection(s, idx);
    listWrap.appendChild(secEl);
    
    // Restore state after section is added to DOM
    if (savedData) {
      restoreState(secEl, s.id, savedData);
    }
  });

  // Update counter
  function updateCounter(sectionEl) {
    const checkboxes = sectionEl.querySelectorAll('.item-checkbox');
    const visibleCheckboxes = Array.from(checkboxes).filter(cb => {
      const row = cb.closest('.item-row');
      return !row.classList.contains('hidden');
    });
    let checked = 0;
    visibleCheckboxes.forEach(cb => { if(cb.checked) checked++; });
    const total = visibleCheckboxes.length;
    const counter = sectionEl.querySelector('.counter-badge');
    if(counter) {
      counter.textContent = checked + '/' + total;
      
      // Add green color if items are selected
      if(checked > 0) {
        counter.classList.add('has-items');
      } else {
        counter.classList.remove('has-items');
      }
    }
    
    // Update total counter
    updateTotalCounter();
  }

  // Update total counter across all sections
  function updateTotalCounter() {
    const allCheckboxes = document.querySelectorAll('.item-checkbox');
    let totalChecked = 0;
    allCheckboxes.forEach(cb => {
      const row = cb.closest('.item-row');
      if (!row.classList.contains('hidden') && cb.checked) {
        totalChecked++;
      }
    });
    const totalCounterEl = document.getElementById('totalCounter');
    if (totalCounterEl) {
      totalCounterEl.textContent = totalChecked;
      
      // Add green color if items are selected
      if(totalChecked > 0) {
        totalCounterEl.classList.add('has-items');
      } else {
        totalCounterEl.classList.remove('has-items');
      }
    }
  }

  // Search functionality
  const searchInput = document.getElementById('searchInput');
  const noResults = document.getElementById('noResults');

  searchInput.addEventListener('input', function() {
    const searchTerm = this.value.toLowerCase().trim();
    let hasResults = false;

    if (searchTerm === '') {
      // Show all
      document.querySelectorAll('.section-card').forEach(sec => {
        sec.classList.remove('hidden');
        sec.querySelectorAll('.item-row').forEach(row => {
          row.classList.remove('hidden');
        });
        updateCounter(sec);
      });
      noResults.style.display = 'none';
      return;
    }

    // Filter items
    document.querySelectorAll('.section-card').forEach(sec => {
      let sectionHasResults = false;
      sec.querySelectorAll('.item-row').forEach(row => {
        const itemName = row.dataset.itemName;
        if (itemName.includes(searchTerm)) {
          row.classList.remove('hidden');
          sectionHasResults = true;
          hasResults = true;
        } else {
          row.classList.add('hidden');
        }
      });

      if (sectionHasResults) {
        sec.classList.remove('hidden');
        // Auto-expand section with results
        const body = sec.querySelector('.section-body');
        const chevron = sec.querySelector('.chevron-icon');
        if (!body.classList.contains('show')) {
          body.classList.add('show');
          chevron.classList.add('rotated');
        }
      } else {
        sec.classList.add('hidden');
      }
      updateCounter(sec);
    });

    if (hasResults) {
      noResults.style.display = 'none';
    } else {
      noResults.style.display = 'block';
    }
  });

  // Restore WhatsApp number and name from localStorage
  const savedWANumber = localStorage.getItem('waNumber');
  if (savedWANumber) {
    document.getElementById('waNumber').value = savedWANumber;
  }

  const savedUserName = localStorage.getItem('userName');
  if (savedUserName) {
    document.getElementById('userName').value = savedUserName;
  }

  // Save WhatsApp number when it changes
  document.getElementById('waNumber').addEventListener('input', (e) => {
    localStorage.setItem('waNumber', e.target.value.trim());
  });

  // Save user name when it changes
  document.getElementById('userName').addEventListener('input', (e) => {
    localStorage.setItem('userName', e.target.value.trim());
  });

  // Share button - Show alert instead of opening WhatsApp
  document.getElementById('shareBtn').addEventListener('click', () => {
    const phone = document.getElementById('waNumber').value.trim();
    const userName = document.getElementById('userName').value.trim();
    
    if(!phone){
      alert('üì± ‡§ï‡•É‡§™‡§Ø‡§æ ‡§µ‡•ç‡§π‡•â‡§ü‡•ç‡§∏‡•≤‡§™ ‡§®‡§Ç‡§¨‡§∞ ‡§ü‡§æ‡§ï‡§æ!');
      return;
    }
    
    // Collect checked items (including custom items)
    const sections = Array.from(document.querySelectorAll('.section-card'));
    const collected = [];
    let totalItemsCount = 0;
    
    sections.forEach(sec => {
      const title = sec.querySelector('.section-title').textContent.trim();
      const rows = Array.from(sec.querySelectorAll('.item-row'));
      const items = [];
      
      rows.forEach(row => {
        const checkbox = row.querySelector('.item-checkbox');
        if(checkbox && checkbox.checked && !row.classList.contains('hidden')){
          const nameDiv = row.querySelector('.item-name');
          
          // Priority: Marathi first, then English/Custom
          let displayName = '';
          const marathiDiv = nameDiv.querySelector('.item-name-marathi');
          
          if(marathiDiv && marathiDiv.textContent.trim() !== ''){
            // Use Marathi name if available
            displayName = marathiDiv.textContent.trim();
          } else {
            // Use English or custom name
            const nameElement = nameDiv.cloneNode(true);
            const marathiDivClone = nameElement.querySelector('.item-name-marathi');
            if(marathiDivClone) marathiDivClone.remove();
            displayName = nameElement.textContent.trim();
          }
          
          const qty = row.querySelector('.qty-input').value.trim();
          items.push({name: displayName, qty});
          totalItemsCount++;
        }
      });
      
      if(items.length > 0){
        collected.push({title, items});
      }
    });
    
    if(collected.length === 0){
      alert('‚ùå ‡§ï‡•ã‡§£‡§§‡•Ä‡§π‡•Ä ‡§µ‡§∏‡•ç‡§§‡•Ç ‡§®‡§ø‡§µ‡§°‡§≤‡•á‡§≤‡•Ä ‡§®‡§æ‡§π‡•Ä!\n\n‡§ï‡•É‡§™‡§Ø‡§æ ‡§ñ‡§∞‡•á‡§¶‡•Ä‡§ö‡•ç‡§Ø‡§æ ‡§Ø‡§æ‡§¶‡•Ä‡§§ ‡§ò‡§æ‡§≤‡§æ‡§Ø‡§ö‡•ç‡§Ø‡§æ ‡§µ‡§∏‡•ç‡§§‡•Ç ‡§®‡§ø‡§µ‡§°‡§æ.');
      return;
    }
    
    // Get current date in dd/mm/yyyy format
    const today = new Date();
    const day = String(today.getDate()).padStart(2, '0');
    const month = String(today.getMonth() + 1).padStart(2, '0');
    const year = today.getFullYear();
    const formattedDate = `${day}/${month}/${year}`;
    
    // Show simplified confirmation dialog
    let confirmMsg = '‚úÖ ‡§ñ‡§∞‡•á‡§¶‡•Ä‡§ö‡•Ä ‡§Ø‡§æ‡§¶‡•Ä ‡§§‡§Ø‡§æ‡§∞ ‡§ù‡§æ‡§≤‡•Ä!\n\n';
    confirmMsg += `üìÖ ‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï: ${formattedDate}\n`;
    confirmMsg += `üìù ‡§è‡§ï‡•Ç‡§£ ‡§µ‡§∏‡•ç‡§§‡•Ç: ${totalItemsCount}\n`;
    confirmMsg += `üì± ‡§™‡§æ‡§†‡§µ‡§æ‡§Ø‡§ö‡§æ ‡§®‡§Ç‡§¨‡§∞: ${phone}\n`;
    if(userName) {
      confirmMsg += `üë§ ‡§®‡§æ‡§µ: ${userName}\n`;
    }
    confirmMsg += '\nüí° ‡§µ‡•ç‡§π‡•â‡§ü‡•ç‡§∏‡•≤‡§™ ‡§µ‡§∞ ‡§™‡§æ‡§†‡§µ‡§æ‡§Ø‡§ö‡•á ‡§ï‡§æ?\n\n';
    confirmMsg += 'OK = ‡§™‡§æ‡§†‡§µ‡§æ | Cancel = ‡§™‡§∞‡§§ ‡§ú‡§æ';
    
    const userConfirmed = confirm(confirmMsg);
    
    // If user clicks Cancel, return without opening WhatsApp
    if(!userConfirmed) {
      return;
    }
    
    // Format message with Marathi title and serial numbers
    let message = 'üõí *‡§ï‡§ø‡§∞‡§æ‡§£‡§æ ‡§ñ‡§∞‡•á‡§¶‡•Ä‡§ö‡•Ä ‡§Ø‡§æ‡§¶‡•Ä*\n';
    message += `üìÖ ‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï: ${formattedDate}\n`;
    message += `üìù ‡§è‡§ï‡•Ç‡§£ ‡§µ‡§∏‡•ç‡§§‡•Ç: ${totalItemsCount}\n`;
    message += '‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n';
    
    let serialNumber = 1;
    collected.forEach((sec, idx) => {
      const sectionTitle = sec.title.split('(')[0].trim(); // Remove Marathi part from section title
      message += `*${sectionTitle}*\n`;
      sec.items.forEach(item => {
        if(item.qty){
          message += `${serialNumber}. ${item.name} ‚Äî ${item.qty}\n`;
        } else {
          message += `${serialNumber}. ${item.name}\n`;
        }
        serialNumber++;
      });
      message += '\n';
    });
    
    message += '‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n';
    
    // Add name at bottom if provided, otherwise show phone
    if(userName) {
      message += `üë§ ${userName}`;
    } else {
      message += `üì± ${phone}`;
    }
    
    // Also prepare WhatsApp link (optional - user can choose)
    let digits = phone.replace(/\D/g, '');
    if(digits.length === 10){
      digits = '91' + digits;
    }
    
    const encoded = encodeURIComponent(message);
    const waUrl = `https://wa.me/${digits}?text=${encoded}`;
    
    // Open WhatsApp
    window.open(waUrl, '_blank');
  });

})();
</script>

</body>
</html>
